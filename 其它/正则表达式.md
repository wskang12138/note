# 正则表达式

## 正则表达式资源 Regular Expression(regex、regexp、RE)



>https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Guide/Regular_Expressions mdn 官网手册
>
>https://juejin.cn/post/6844903501034684430 正则表达式迷你书

### 核心思想

**正则表达式是匹配模式，要么****匹配字符****，要么****匹配位置****。**



## 字符匹配

### 模糊匹配

- 横向模糊
- 纵向模糊



### 字符组

使用中括号 [ ] 表示。 

- 范围表示法
- 排除字符法
- 简写形式。不能在构造函数中使用简写形式。



| \d   | [0-9]。英文 digit 的缩写。                                   |
| ---- | ------------------------------------------------------------ |
| \D   | [^0-9]。表示除数字外的任意字符。                             |
| \w   | [0-9a-zA-Z_]。表示数字、大小写字母和下划线。英文 word 的缩写。 |
| \W   | [^0-9a-zA-Z_]。表示非单词字符。                              |
| \s   | [\t\v\n\r\f]。表示空白符，包括空格、水平制表符、垂直制表符、换行符、回车符、换页符。英文 space 的缩写。 |
| \S   | [^\t\v\n\r\f]。除空白符外的任意字符。                        |
| .    | [^\n\r\u2028\u2029]。通配符，表示除换行符、回车符、行分隔符和段分隔符外的所有字符。省略号 … 中的每个点表示任意拓展。 |
|      |                                                              |

`[\u4e00-\u9fa5]` 匹配一个汉字

### 量词

使用大括号限制量词范围时范围不能中间出现空格

| {m, } | 表示至少出现 m 次 |
| ----- | ----------------- |
| {m}   | 出现 m 次         |
| ？    | {0，1}            |
| +     | {1，}             |
| *     | {0，}             |



### 贪婪模式和惰性匹配

- 贪婪模式为尽可能完美地匹配，惰性匹配为尽可能少地匹配以满足最低要求便可。
- 在量词后面添加 ？即可实现惰性匹配。
- 对惰性匹配的记忆方式是：量词后面加个问号，还不知足吗，要贪婪吗？  



### 多选分支

用于实现支持多个子模式任选其一。通过 `|` 管道符分隔。其匹配模式是惰性的，满足条件后便不在往后匹配。

 

## 位置匹配（位置看成为空字符)

常用 6 锚。

### ^ 和 $

`^`（脱字符）匹配行开头

`$` 匹配行结尾



### \b 和 \B

`\b` 是单词边界，具体就是 \w 和 \W 之间的位置，也包括 \w 和 ^ ，\w 和 $ 之间的位置。

`\B`是除单词边界外的位置。



### (?=p) 和 (?!p)

`(?=p)`（正向先行断言 ） 匹配子模式 p 前面的位置。也理解成：要求接下来的字符与 p 匹配，但不包含 p 匹配的那些字符。

`(?!p)`（负向先行断言） 匹配除了子模式 p 前面位置外的其他位置。



### (?<=p) 和 (?<!p)

其匹配原理同先行断言，只不过这两者是向前匹配。



## 分组

### 捕获和提取数据

分组信息（使用括号匹配）储存到全局对象 RegExp 属性 `$1` 到 `$9` 中



### 反向引用

`\分组号码` 用于表示引用之前的分组，不管它匹配到什么，`\分组号码` 都匹配相同的某个字符。如果分组不存在则表示引用字符自身。

eg: `\1, \2, \3, ... , \10` 。



### 非捕获括号

通过在括号最前面添加 `?:` 便能使用括号的原始功能

## 匹配回溯

回溯法也称为试探法，基本思想是从问题的某一种初始状态出发，搜索这中状态能所能到达的所有状态，当一条路走到尽头的时候，再后退到一步到若干步，直到所有路径都探索过。

回溯是在进行匹配遇到不符合的情况时回退到前一符合的情况上继续往下进行匹配。

![img](https://cdn.nlark.com/yuque/0/2021/png/12905753/1634800392457-856d117b-3099-4174-9c6b-520f84aca3cb.png)

![img](https://cdn.nlark.com/yuque/0/2021/png/12905753/1634800504985-3faf0a53-95fd-499c-a16d-92cdb8d02409.png)

## 正则表达式拆分

### 操作符优先级

| 操作符描述   | 操作符                  | 优先级 |
| ------------ | ----------------------- | ------ |
| 转义符       | \                       | 1      |
| 括号和方括号 | (...)、[...]            | 2      |
| 量词限定符   | {m, }、？、*、+         | 3      |
| 位置和序列   | ^、$、\元字符、一般字符 | 4      |
| 管道符       | \|                      |        |

## 构建正则表达式

### 平衡法则

- 匹配预期的字符串
- 不匹配非预期的字符串
- 可读性和可维护性
- 效率

### 构建前提

-  是否能用
- 是否有必要用
- 是否有必要构建复杂正则

### 元字符转义

只要不在字符组内便不需要转义，特殊：括号前后都需要转义。

#### 

## 正则表达式编程

### 验证

- string#search(regex) => stringIndex | -1
- regex#test(string) => boolean
- string#match(regex) => array
- regex#exec(string) => array

### 切分

- string#split(regex) => array

### 提取

- string#search(regex)
- regex#test(string)
- string#match(regex) => array | null
- regex#exec(string) 
- regex#replace(regex, func)

### 替换

- regex#replace(regex, func)



## 创建正则表达式对象

### 字面量（优先推荐）

```js
console.log(/\d{5}/.test('我是啦啦啦123')); // false
```

### 构造函数

```js
let regexp = new RegExp("pattern ", "flags");
let res = regexp.test('我是啦啦啦12345'); 
console.log(res); // true
```

## 修饰符 flags

| 修饰符 | 描述                                                         |
| ------ | ------------------------------------------------------------ |
| g      | 全局匹配，找到所有匹配的，单词 global                        |
| i      | 忽略字母大小写，单词 ignoreCase                              |
| m      | 多行匹配，只影响 ^ 和 $，两者变成行的概念（行开头和行结尾），单词 multiline |

## 实践技巧

1. 带有至少、等字样的匹配无法确定字符特定顺序时，可以考虑使用先行或后行断言从位置进行断定。
2. 表单提交控件输入内容直接使用行头 ^ 和行尾 $ 进行匹配，去除使用 js 判断两端空格的处理逻辑。
3. 正则表达式如果需要进行精确匹配则**需要结合位置**来确定，否则只要符号字符串匹配便成立。